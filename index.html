<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate DJ Studio</title>
<style>
body{margin:0;background:#111;color:#eee;font-family:sans-serif;display:flex;flex-direction:column;align-items:center;}
#app{width:95%;max-width:1400px;margin:10px;}
h1{text-align:center;margin-bottom:10px;}
.panel{background:linear-gradient(145deg,#1a1a1a,#222);border-radius:12px;padding:20px;margin:10px;display:flex;flex-wrap:wrap;justify-content:center;}
.knob-container{display:flex;flex-direction:column;align-items:center;margin:10px;}
.knob, .slider{width:60px;height:60px;border-radius:50%;background:linear-gradient(145deg,#333,#111);border:4px solid #555;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;box-shadow:2px 2px 5px #000 inset,-2px -2px 5px #555 inset;}
.knob:after{content:'';position:absolute;width:4px;height:20px;background:#ff5722;top:10px;left:50%;transform:translateX(-50%) rotate(0deg);transform-origin:bottom center;transition: transform 0.1s;border-radius:2px;}
.label{margin-top:8px;font-size:14px;text-align:center;}
.pad{width:60px;height:60px;background:linear-gradient(145deg,#222,#333);margin:5px;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;user-select:none;box-shadow:2px 2px 5px #000 inset,-2px -2px 5px #555 inset;font-weight:bold;}
.pad.active{background:#ff5722;box-shadow:none;}
#sequencer{display:flex;flex-wrap:wrap;justify-content:center;margin-top:10px;}
.step{width:30px;height:30px;margin:2px;border-radius:4px;background:#333;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:2px 2px 4px #000 inset,-2px -2px 4px #555 inset;}
.step.active{background:#ff5722;}
#visualizer{width:100%;height:160px;background:#111;margin-top:20px;border:1px solid #333;border-radius:8px;}
button{background:#333;border:none;color:#eee;padding:8px 12px;border-radius:6px;margin:4px;cursor:pointer;font-weight:bold;box-shadow:2px 2px 5px #000 inset,-2px -2px 5px #555 inset;}
button:hover{background:#555;}
#startAudioBtn{background:#43a047;}
@media(max-width:768px){
  .knob, .slider{width:50px;height:50px;}
  .pad{width:50px;height:50px;}
  .step{width:25px;height:25px;}
}
</style>
</head>
<body>
<div id="app">
<h1>Ultimate DJ Studio</h1>
<div class="panel" id="controlsPanel">
  <button id="startAudioBtn">Start Audio</button>
</div>
<div class="panel" id="padPanel"></div>
<div class="panel" id="sequencer"></div>
<canvas id="visualizer"></canvas>
<script>
// -----------------------------
// Audio Context & Master Controls
// -----------------------------
let ctx, masterGain, masterPlaybackRate=1, audioStarted=false;
const startBtn=document.getElementById('startAudioBtn');

startBtn.onclick=async ()=>{
  if(!audioStarted){
    ctx=new (window.AudioContext||window.webkitAudioContext)();
    masterGain=ctx.createGain(); masterGain.gain.value=0.8; masterGain.connect(ctx.destination);
    audioStarted=true; startBtn.textContent='Audio Playing';
    initPads();
    initSequencer();
    initFX();
    initVisualizer();
  } else {
    await ctx.suspend(); audioStarted=false; startBtn.textContent='Audio Stopped';
  }
};

// -----------------------------
// Pads & Samples
// -----------------------------
const padPanel=document.getElementById('padPanel');
const padNames=['Kick','Snare','HiHat','Clap','Piano','Trumpet','Synth'];
const sampleBuffers={};
const base64Samples={
'Kick':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=',
'Snare':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=',
'HiHat':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=',
'Clap':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=',
'Piano':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=',
'Trumpet':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=',
'Synth':'UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA='
};

async function loadSamples(){
  for(const name in base64Samples){
    const res=await fetch('data:audio/wav;base64,'+base64Samples[name]);
    const arrayBuffer=await res.arrayBuffer();
    sampleBuffers[name]=await ctx.decodeAudioData(arrayBuffer);
  }
}

function playSample(name){
  if(!sampleBuffers[name]) return;
  const src=ctx.createBufferSource(); src.buffer=sampleBuffers[name];
  src.playbackRate.value=masterPlaybackRate;
  src.connect(masterGain); src.start();
}

function initPads(){
  loadSamples().then(()=>{
    padNames.forEach(name=>{
      const pad=document.createElement('div'); pad.className='pad'; pad.textContent=name;
      pad.onclick=()=>{ if(audioStarted) playSample(name); pad.classList.add('active'); setTimeout(()=>pad.classList.remove('active'),150); };
      padPanel.appendChild(pad);
    });
  });
}
<script>
// -----------------------------
// Sequencer Setup
// -----------------------------
const sequencer=document.getElementById('sequencer');
let sequencerData={};

function initSequencer(){
  padNames.forEach(track=>{
    sequencerData[track]=new Array(16).fill(false);
    for(let i=0;i<16;i++){
      const step=document.createElement('div'); step.className='step'; step.dataset.track=track; step.dataset.step=i;
      step.onclick=()=>{ sequencerData[track][i]=!sequencerData[track][i]; step.classList.toggle('active',sequencerData[track][i]); };
      sequencer.appendChild(step);
    }
  });
}

// -----------------------------
// DJ Presets (16-step patterns per track)
// -----------------------------
const presets={
'John Summit':{
  'Kick':[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
  'Snare':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'HiHat':[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
  'Clap':[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],
  'Piano':[0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0],
  'Trumpet':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'Synth':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0]
},
'Fisher':{
  'Kick':[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
  'Snare':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'HiHat':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],
  'Clap':[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],
  'Piano':[0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1],
  'Trumpet':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'Synth':[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]
},
'Dom Dolla':{
  'Kick':[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
  'Snare':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'HiHat':[1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
  'Clap':[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],
  'Piano':[0,0,1,0,1,0,1,0,0,0,1,0,1,0,1,0],
  'Trumpet':[0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],
  'Synth':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0]
},
'Ben Böhmer':{
  'Kick':[1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
  'Snare':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  'HiHat':[0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1],
  'Clap':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  'Piano':[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],
  'Trumpet':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  'Synth':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0]
},
'Barry Can’t Swim':{
  'Kick':[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
  'Snare':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  'HiHat':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],
  'Clap':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  'Piano':[0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1],
  'Trumpet':[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  'Synth':[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]
},
'Zhu':{
  'Kick':[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],
  'Snare':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'HiHat':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],
  'Clap':[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],
  'Piano':[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],
  'Trumpet':[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],
  'Synth':[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]
}
};

// Apply Preset Function
function applyPreset(name){
  const data=presets[name];
  if(!data) return;
  padNames.forEach(track=>sequencerData[track]=[...data[track]]);
  document.querySelectorAll('.step').forEach(step=>{
    const track=step.dataset.track; const i=parseInt(step.dataset.step);
    step.classList.toggle('active',sequencerData[track][i]);
  });
}

// Create Preset Buttons
Object.keys(presets).forEach(name=>{
  const btn=document.createElement('button'); btn.textContent=name;
  btn.onclick=()=>applyPreset(name);
  document.getElementById('controlsPanel').appendChild(btn);
});

// -----------------------------
// FX Rack
// -----------------------------
const trackFX={};
function initFX(){
  padNames.forEach(track=>{
    const filter=ctx.createBiquadFilter(); filter.type='lowpass'; filter.frequency.value=20000;
    const delay=ctx.createDelay(); delay.delayTime.value=0.25;
    const gain=ctx.createGain(); gain.gain.value=0.8;
    filter.connect(delay); delay.connect(gain); gain.connect(masterGain);
    trackFX[track]={filter,delay,gain};
  });
  // Master Controls
  const masterPitchKnob=document.createElement('div'); masterPitchKnob.className='knob';
  const masterPitchLabel=document.createElement('div'); masterPitchLabel.className='label'; masterPitchLabel.textContent='Master Pitch';
  const masterVolKnob=document.createElement('div'); masterVolKnob.className='knob';
  const masterVolLabel=document.createElement('div'); masterVolLabel.className='label'; masterVolLabel.textContent='Master Volume';
  const container=document.getElementById('controlsPanel');
  [masterPitchKnob,masterPitchLabel,masterVolKnob,masterVolLabel].forEach(el=>container.appendChild(el));
  createControl(masterPitchKnob,v=>{ masterPlaybackRate=0.5+v*1.5; });
  createControl(masterVolKnob,v=>{ masterGain.gain.value=v; });
}

// -----------------------------
// Sequencer Loop
// -----------------------------
let stepCounter=0;
const bpm=120;
function highlightStep(stepIndex){
  document.querySelectorAll('.step').forEach(step=>{ step.style.borderColor=''; if(parseInt(step.dataset.step)===stepIndex) step.style.borderColor='#ff5722'; });
}
function sequencerLoop(){
  if(!audioStarted) return setTimeout(sequencerLoop,100);
  padNames.forEach(track=>{ if(sequencerData[track][stepCounter]) playSample(track); });
  highlightStep(stepCounter);
  stepCounter=(stepCounter+1)%16;
  setTimeout(sequencerLoop,(60000/bpm)/4);
}
sequencerLoop();

// -----------------------------
// Randomization Engine
// -----------------------------
function randomizeSequence(intensity=0.3){
  padNames.forEach(track=>{
    sequencerData[track]=sequencerData[track].map(()=>Math.random()<intensity);
  });
  document.querySelectorAll('.step').forEach(step=>{
    const track=step.dataset.track; const i=parseInt(step.dataset.step);
    step.classList.toggle('active',sequencerData[track][i]);
  });
}
const randBtn=document.createElement('button'); randBtn.textContent='Randomize Sequence';
randBtn.onclick=()=>randomizeSequence(0.3);
document.getElementById('controlsPanel').appendChild(randBtn);

// -----------------------------
// Voice Recorder + Download
// -----------------------------
let recorder, recordedChunks=[], recording=false;
const recBtn=document.createElement('button'); recBtn.textContent='Record Voice';
const downloadBtn=document.createElement('button'); downloadBtn.textContent='Download Voice';
document.getElementById('controlsPanel').appendChild(recBtn);
document.getElementById('controlsPanel').appendChild(downloadBtn);

recBtn.onclick=async ()=>{
  if(!recording){
    const stream=await navigator.mediaDevices.getUserMedia({audio:true});
    recorder=new MediaRecorder(stream);
    recordedChunks=[];
    recorder.ondataavailable=e=>{ if(e.data.size>0) recordedChunks.push(e.data); };
    recorder.start(); recording=true; recBtn.textContent='Stop Recording';
  } else {
    recorder.stop(); recording=false; recBtn.textContent='Record Voice';
  }
};

downloadBtn.onclick=()=>{
  if(recordedChunks.length===0) return;
  const blob=new Blob(recordedChunks,{type:'audio/webm'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='voice_recording.webm'; a.click();
  URL.revokeObjectURL(url);
};
</script>
<script>
// -----------------------------
// Visualizer Setup
// -----------------------------
function initVisualizer(){
  const canvas=document.getElementById('visualizer');
  const ctxVis=canvas.getContext('2d');
  canvas.width=canvas.clientWidth; canvas.height=canvas.clientHeight;
  const analyser=ctx.createAnalyser();
  masterGain.connect(analyser);
  analyser.fftSize=256;
  const bufferLength=analyser.frequencyBinCount;
  const dataArray=new Uint8Array(bufferLength);

  function drawVisualizer(){
    requestAnimationFrame(drawVisualizer);
    analyser.getByteFrequencyData(dataArray);
    ctxVis.fillStyle='#111'; ctxVis.fillRect(0,0,canvas.width,canvas.height);
    const barWidth=canvas.width/bufferLength;
    for(let i=0;i<bufferLength;i++){
      const barHeight=dataArray[i]/2;
      ctxVis.fillStyle=`rgb(${barHeight+50},50,${255-barHeight})`;
      ctxVis.fillRect(i*barWidth,canvas.height-barHeight,barWidth,barHeight);
    }
  }
  drawVisualizer();
}

// -----------------------------
// Vertical Sliders for Touch
// -----------------------------
function createControl(el,callback){
  let value=0.5;
  function updateKnob(v){
    value=v;
    el.querySelector('span')?.remove();
    const angle=-135+v*270;
    el.style.setProperty('--angle',angle+'deg');
    callback(value);
  }

  let isDragging=false;
  function getValueFromEvent(e){
    const rect=el.getBoundingClientRect();
    const y=(e.touches?e.touches[0].clientY:e.clientY)-rect.top;
    let v=1-y/rect.height; if(v<0)v=0;if(v>1)v=1;
    updateKnob(v);
  }

  el.onmousedown=()=>{ isDragging=true; };
  el.onmousemove=e=>{ if(isDragging)getValueFromEvent(e); };
  el.onmouseup=()=>{ isDragging=false; };
  el.ontouchstart=e=>{ getValueFromEvent(e); e.preventDefault(); };
  el.ontouchmove=e=>{ getValueFromEvent(e); e.preventDefault(); };
  el.ontouchend=()=>{ isDragging=false; };

  // Initial
  updateKnob(value);
}

// -----------------------------
// Add Vertical Sliders for FX
// -----------------------------
Object.keys(trackFX).forEach(track=>{
  const container=document.getElementById('controlsPanel');
  ['filter','delay','gain'].forEach(param=>{
    const slider=document.createElement('div'); slider.className='slider';
    const label=document.createElement('div'); label.className='label'; label.textContent=`${track} ${param}`;
    container.appendChild(slider); container.appendChild(label);
    createControl(slider,v=>{
      if(param==='filter') trackFX[track].filter.frequency.value=500+v*15000;
      if(param==='delay') trackFX[track].delay.delayTime.value=v*0.5;
      if(param==='gain') trackFX[track].gain.gain.value=v;
    });
  });
});

// -----------------------------
// Extra Finishing Touches
// -----------------------------
function finishAesthetic(){
  document.querySelectorAll('.knob, .slider').forEach(el=>{
    el.style.background='linear-gradient(145deg,#222,#111)';
    el.style.border='4px solid #555';
    el.style.boxShadow='2px 2px 5px #000 inset,-2px -2px 5px #555 inset';
  });
  document.querySelectorAll('.pad').forEach(el=>{
    el.style.borderRadius='8px';
    el.style.boxShadow='2px 2px 5px #000 inset,-2px -2px 5px #555 inset';
  });
}
finishAesthetic();
</script>
</body>
</html>  
